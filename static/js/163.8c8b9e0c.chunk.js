(this["webpackJsonpmap-sample"]=this["webpackJsonpmap-sample"]||[]).push([[163],{776:function(e,a,t){"use strict";t.r(a),t.d(a,"previewSymbol2D",(function(){return v}));var l=t(14),n=t(19),i=t(34),s=t(33),o=t(350),c=t(694),r=t(719),u="picture-fill",m=120,p=document.createElement("canvas");function h(e,a){var t=p.getContext("2d"),l=[];return a&&(a.weight&&l.push(a.weight),a.size&&l.push(a.size+"px"),a.family&&l.push(a.family)),t.font=l.join(" "),t.measureText(e).width}function d(e){if(0===e.length)return 0;if(e.length>2){var a=Object(s.e)(1),t=parseFloat(e);switch(e.slice(-2)){case"px":return t;case"pt":return t*a;case"in":return 72*t*a;case"pc":return 12*t*a;case"mm":return 2.8346456692913384*t*a;case"cm":return 28.346456692913385*t*a}}return parseFloat(e)}function v(e,a){var t,p,v=null!=(null==a?void 0:a.size)?Object(s.d)(a.size):null,f=null!=(null==a?void 0:a.maxSize)?Object(s.d)(a.maxSize):null,b=null!=(null==a?void 0:a.opacity)?a.opacity:null,y=null!=(null==a?void 0:a.rotation)?a.rotation:"angle"in e?e.angle:null,w=Object(o.b)(e),g=Object(o.d)(e);if(w&&!g){var M="type"in w?null:new i.a(w);"#ffffff"===(M?M.toHex():null)&&(g={color:"#bdc3c7",width:.75})}var j={shape:null,fill:null,stroke:g,offset:[0,0]};null!=(t=g)&&t.width&&(g.width=Math.min(g.width,80));var k=(null==(p=g)?void 0:p.width)||0,O=null!=v&&(null==(null==a?void 0:a.scale)||(null==a?void 0:a.scale)),x=0,L=0,z=!1;switch(e.type){case"simple-marker":var C=e.style,F=Math.min(null!=v?v:Object(s.d)(e.size),f||m);switch(x=F,L=F,C){case"circle":j.shape={type:"circle",cx:0,cy:0,r:.5*F},O||(x+=k,L+=k);break;case"cross":j.shape={type:"path",path:[{command:"M",values:[0,.5*L]},{command:"L",values:[x,.5*L]},{command:"M",values:[.5*x,0]},{command:"L",values:[.5*x,L]}]};break;case"diamond":j.shape={type:"path",path:[{command:"M",values:[0,.5*L]},{command:"L",values:[.5*x,0]},{command:"L",values:[x,.5*L]},{command:"L",values:[.5*x,L]},{command:"Z",values:[]}]},O||(x+=k,L+=k);break;case"square":j.shape={type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[x,0]},{command:"L",values:[x,L]},{command:"L",values:[0,L]},{command:"Z",values:[]}]},O||(x+=k,L+=k),y&&(z=!0);break;case"triangle":j.shape={type:"path",path:[{command:"M",values:[.5*x,0]},{command:"L",values:[x,L]},{command:"L",values:[0,L]},{command:"Z",values:[]}]},O||(x+=k,L+=k),y&&(z=!0);break;case"x":j.shape={type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[x,L]},{command:"M",values:[x,0]},{command:"L",values:[0,L]}]},y&&(z=!0);break;case"path":j.shape={type:"path",path:e.path||""},O||(x+=k,L+=k),y&&(z=!0),O=!0}break;case"simple-line":var S=Math.min(null!=v?v:k,f||80),P=S>22?2*S:40;g.width=S,x=P,L=S,j.shape={type:"path",path:[{command:"M",values:[0,L]},{command:"L",values:[x,L]}]};break;case u:case"simple-fill":x=Math.min(null!=v?v:22,f||m)+k,L=x,O=!0,j.shape="object"==typeof(null==a?void 0:a.symbolConfig)&&null!=a&&a.symbolConfig.isSquareFill?c.l.squareFill[0]:c.l.fill[0];break;case"picture-marker":var q=Object(s.d)(e.width),E=Object(s.d)(e.height),Z=Math.max(q,E),D=q/E;q=D<=1?Math.ceil(Z*D):Z,E=D<=1?Z:Math.ceil(Z/D),x=Math.min(null!=v?v:q,f||m),L=Math.min(null!=v?v:E,f||m),j.shape={type:"image",x:-Math.round(x/2),y:-Math.round(L/2),width:x,height:L,src:e.url||""},y&&(z=!0);break;case"text":var H=e,J=H.text||"Aa",T=H.font,A=Math.min(null!=v?v:Object(s.d)(T.size),f||m),R=h(J,{weight:T.weight,size:A,family:T.family}),B=/[\uE600-\uE6FF]/.test(J);x=B?A:R,L=A;var G=.25*d((T?A:0).toString());B&&(G+=5),j.shape={type:"text",text:J,x:0,y:G,align:"middle",decoration:T&&T.decoration,rotated:H.rotated,kerning:H.kerning},j.font=T&&{size:A,style:T.style,decoration:T.decoration,weight:T.weight,family:T.family}}if(!j.shape)return Promise.reject(new n.a("symbolPreview: renderPreviewHTML2D","symbol not supported."));var I=w,K=e.color,N=null;return I&&"pattern"===I.type&&K&&e.type!==u?N=Object(o.c)(I.src,K.toCss(!0)).then((function(e){return I.src=e,j.fill=I,j})):(j.fill=w,N=Promise.resolve(j)),N.then((function(e){var t=[[e]];if("object"==typeof(null==a?void 0:a.symbolConfig)&&null!=a&&a.symbolConfig.applyColorModulation){var n=.6*x;t.unshift([Object(l.a)(Object(l.a)({},e),{},{offset:[-n,0],fill:Object(c.a)(w,-.3)})]),t.push([Object(l.a)(Object(l.a)({},e),{},{offset:[n,0],fill:Object(c.a)(w,.3)})]),x+=2*n}return Object(r.a)(t,[x,L],{node:a&&a.node,scale:O,opacity:b,rotation:y,useRotationSize:z})}))}}}]);
//# sourceMappingURL=163.8c8b9e0c.chunk.js.map