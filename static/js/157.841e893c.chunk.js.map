{"version":3,"sources":["../node_modules/@arcgis/core/layers/TileLayer.js"],"names":["W","A","e","listMode","isReference","operationalLayerType","resampling","sourceJSON","spatialReference","path","sublayers","type","url","r","t","signal","this","addResolvingPromise","loadFromPortal","supportedTypes","then","_fetchService","Promise","resolve","parsedUrl","toLowerCase","_getDefaultAttribution","_getMapName","tileInfo","u","fromJSON","s","loaded","o","slice","reverse","flatten","toArray","i","a","writeSublayerStructure","forEach","write","push","some","Object","keys","length","layers","_getDefaultTileServers","Array","isArray","map","n","timestamp","getTileUrl","l","responseType","query","_ts","m","data","tilemapCache","supportsBlankTile","p","blankTile","customParameters","tileServers","bandCount","pixelSizeX","y","serverType","f","ssl","replace","read","origin","version","_fetchServerVersion","currentVersion","catch","v","reject","match","indexOf","c","search","j","P","T","O","S","w","R","x","_","h","L","b","d","readOnly","prototype","Boolean","json","enabled","overridePolicy","String","origins","U","g","C"],"mappings":"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","file":"static/js/157.841e893c.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../chunks/tslib.es6.js\";import\"../core/has.js\";import{isSome as r}from\"../core/maybe.js\";import\"../core/Logger.js\";import{property as t}from\"../core/accessorSupport/decorators/property.js\";import{cast as s}from\"../core/accessorSupport/decorators/cast.js\";import{reader as o}from\"../core/accessorSupport/decorators/reader.js\";import{subclass as i}from\"../core/accessorSupport/decorators/subclass.js\";import{writer as a}from\"../core/accessorSupport/decorators/writer.js\";import l from\"../core/Error.js\";import{urlToObject as n,objectToQuery as p,makeAbsolute as c}from\"../core/urlUtils.js\";import\"../core/uuid.js\";import\"../portal/support/resourceExtension.js\";import u from\"../geometry/SpatialReference.js\";import\"../geometry.js\";import m from\"../request.js\";import d from\"./Layer.js\";import{MultiOriginJSONMixin as h}from\"../core/MultiOriginJSONSupport.js\";import{parse as y,isHostedAgolService as f,isArcGISUrl as v}from\"./support/arcgisLayerUrl.js\";import{url as g}from\"./support/commonProperties.js\";import{OperationalLayer as S}from\"./mixins/OperationalLayer.js\";import{ArcGISService as _}from\"./mixins/ArcGISService.js\";import{BlendLayer as j}from\"./mixins/BlendLayer.js\";import{CustomParametersMixin as b}from\"./mixins/CustomParametersMixin.js\";import{PortalLayer as w}from\"./mixins/PortalLayer.js\";import{RefreshableLayer as O}from\"./mixins/RefreshableLayer.js\";import{ScaleRangeLayer as T}from\"./mixins/ScaleRangeLayer.js\";import{HandleOwnerMixin as L}from\"../core/HandleOwner.js\";import{ArcGISCachedService as R}from\"./mixins/ArcGISCachedService.js\";import{ArcGISMapService as x}from\"./mixins/ArcGISMapService.js\";import U from\"./support/Sublayer.js\";import{SublayersOwner as P}from\"./mixins/SublayersOwner.js\";const W=[\"Canvas/World_Dark_Gray_Base\",\"Canvas/World_Dark_Gray_Reference\",\"Canvas/World_Light_Gray_Base\",\"Canvas/World_Light_Gray_Reference\",\"Elevation/World_Hillshade\",\"Elevation/World_Hillshade_Dark\",\"Ocean/World_Ocean_Base\",\"Ocean/World_Ocean_Reference\",\"Ocean_Basemap\",\"Reference/World_Boundaries_and_Places\",\"Reference/World_Boundaries_and_Places_Alternate\",\"Reference/World_Transportation\",\"World_Imagery\",\"World_Street_Map\",\"World_Topo_Map\"];let A=class extends(j(P(T(O(S(w(R(x(_(h(L(b(d))))))))))))){constructor(...e){super(...e),this.listMode=\"show\",this.isReference=null,this.operationalLayerType=\"ArcGISTiledMapServiceLayer\",this.resampling=!0,this.sourceJSON=null,this.spatialReference=null,this.path=null,this.sublayers=null,this.type=\"tile\",this.url=null}normalizeCtorArgs(e,r){return\"string\"==typeof e?{url:e,...r}:e}load(e){const t=r(e)?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:[\"Map Service\"]},e).then((()=>this._fetchService(t)),(()=>this._fetchService(t)))),Promise.resolve(this)}get attributionDataUrl(){var e;const r=null==(e=this.parsedUrl)?void 0:e.path.toLowerCase();return r&&this._getDefaultAttribution(this._getMapName(r))}readSpatialReference(e,r){return(e=e||r.tileInfo&&r.tileInfo.spatialReference)&&u.fromJSON(e)}writeSublayers(e,r,t,s){if(!this.loaded||!e)return;const o=e.slice().reverse().flatten((({sublayers:e})=>e&&e.toArray().reverse())).toArray(),i=[],a={writeSublayerStructure:!1,...s};o.forEach((e=>{const r=e.write({},a);i.push(r)}));i.some((e=>Object.keys(e).length>1))&&(r.layers=i)}get tileServers(){return this._getDefaultTileServers(this.parsedUrl.path)}castTileServers(e){return Array.isArray(e)?e.map((e=>n(e).path)):null}fetchTile(e,r,t,s={}){const{signal:o,timestamp:i}=s,a=this.getTileUrl(e,r,t),l={responseType:\"image\",signal:o};return null!=i&&(l.query={_ts:s.timestamp}),m(a,l).then((e=>e.data))}getTileUrl(e,r,t){const s=!this.tilemapCache&&this.supportsBlankTile,o=p({...this.parsedUrl.query,blankTile:!s&&null,...this.customParameters}),i=this.tileServers;return`${i&&i.length?i[r%i.length]:this.parsedUrl.path}/tile/${e}/${r}/${t}${o?\"?\"+o:\"\"}`}_fetchService(e){return new Promise(((t,s)=>{if(this.sourceJSON){if(null!=this.sourceJSON.bandCount&&null!=this.sourceJSON.pixelSizeX)throw new l(\"tile-layer:unsupported-url\",\"use ImageryTileLayer to open a tiled image service\");return void t({data:this.sourceJSON})}if(!this.parsedUrl)throw new l(\"tile-layer:undefined-url\",\"layer's url is not defined\");const o=y(this.parsedUrl.path);if(r(o)&&\"ImageServer\"===o.serverType)throw new l(\"tile-layer:unsupported-url\",\"use ImageryTileLayer to open a tiled image service\");m(this.parsedUrl.path,{query:{f:\"json\",...this.parsedUrl.query,...this.customParameters},responseType:\"json\",signal:e}).then(t,s)})).then((r=>{if(r.ssl&&(this.url=this.url.replace(/^http:/i,\"https:\")),this.sourceJSON=r.data,this.read(r.data,{origin:\"service\",url:this.parsedUrl}),10.1===this.version&&!f(this.url))return this._fetchServerVersion(this.url,e).then((e=>{this.read({currentVersion:e})})).catch((()=>{}))}))}_fetchServerVersion(e,r){if(!v(e))return Promise.reject();const t=e.replace(/(.*\\/rest)\\/.*/i,\"$1\")+\"/info\";return m(t,{query:{f:\"json\",...this.customParameters},responseType:\"json\",signal:r}).then((e=>{if(e.data&&e.data.currentVersion)return e.data.currentVersion;throw new l(\"tile-layer:version-not-available\")}))}_getMapName(e){const r=e.match(/^(?:https?:)?\\/\\/(server\\.arcgisonline\\.com|services\\.arcgisonline\\.com|ibasemaps-api\\.arcgis\\.com)\\/arcgis\\/rest\\/services\\/([^\\/]+(\\/[^\\/]+)*)\\/mapserver/i);return r&&r[2]}_getDefaultAttribution(e){if(!e)return;let r;e=e.toLowerCase();for(let t=0,s=W.length;t<s;t++)if(r=W[t],r.toLowerCase().indexOf(e)>-1)return c(\"//static.arcgis.com/attribution/\"+r)}_getDefaultTileServers(e){const r=-1!==e.search(/^(?:https?:)?\\/\\/server\\.arcgisonline\\.com/i),t=-1!==e.search(/^(?:https?:)?\\/\\/services\\.arcgisonline\\.com/i);return r||t?[e,e.replace(r?/server\\.arcgisonline/i:/services\\.arcgisonline/i,r?\"services.arcgisonline\":\"server.arcgisonline\")]:[]}};e([t({readOnly:!0})],A.prototype,\"attributionDataUrl\",null),e([t({type:[\"show\",\"hide\",\"hide-children\"]})],A.prototype,\"listMode\",void 0),e([t({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],A.prototype,\"isReference\",void 0),e([t({readOnly:!0,type:[\"ArcGISTiledMapServiceLayer\"]})],A.prototype,\"operationalLayerType\",void 0),e([t({type:Boolean})],A.prototype,\"resampling\",void 0),e([t()],A.prototype,\"sourceJSON\",void 0),e([t({type:u})],A.prototype,\"spatialReference\",void 0),e([o(\"spatialReference\",[\"spatialReference\",\"tileInfo\"])],A.prototype,\"readSpatialReference\",null),e([t({type:String,json:{origins:{\"web-scene\":{read:!0,write:!0}},read:!1}})],A.prototype,\"path\",void 0),e([t({readOnly:!0})],A.prototype,\"sublayers\",void 0),e([a(\"sublayers\",{layers:{type:[U]}})],A.prototype,\"writeSublayers\",null),e([t({json:{read:!1,write:!1}})],A.prototype,\"popupEnabled\",void 0),e([t()],A.prototype,\"tileServers\",null),e([s(\"tileServers\")],A.prototype,\"castTileServers\",null),e([t({readOnly:!0,json:{read:!1}})],A.prototype,\"type\",void 0),e([t(g)],A.prototype,\"url\",void 0),A=e([i(\"esri.layers.TileLayer\")],A);var C=A;export default C;\n"],"sourceRoot":""}