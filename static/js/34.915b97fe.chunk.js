(this["webpackJsonpmap-sample"]=this["webpackJsonpmap-sample"]||[]).push([[34],{611:function(e,t,r){"use strict";r.r(t);var n=r(7),a=r.n(n),i=r(17),o=r(13),c=r(2),s=r(3),l=r(5),u=r(4),h=r(0),d=(r(12),r(8)),p=r(10),v=(r(14),r(1)),b=r(25),y=r(6),f=r(19),j=r(9),O=(r(15),r(16),r(21)),m=r(55),g=r(174),k=r(253),w=r(166),_=r(99),S=r(256),x=r(266),T=r(254),L=r(359),I=r(11),D=r(214),V=r(108),E=r(265),M=p.a.getLogger("esri.core.workers.WorkerHandle"),P=function(e){Object(l.a)(r,e);var t=Object(u.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,"LercWorker","_decode",e,{strategy:"dedicated"})).scheduler=e,n}return Object(s.a)(r,[{key:"decode",value:function(e,t,r){return e&&0!==e.byteLength?this.invoke({buffer:e,options:t},r):Promise.resolve(null)}},{key:"getTransferList",value:function(e){return[e.buffer]}}]),r}(function(){function e(t,r,n){var a=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};Object(c.a)(this,e),this._mainMethod=r,this._listeners=[],this._promise=Object(E.b)(t,Object(o.a)(Object(o.a)({},i),{},{scheduler:n})).then((function(e){if(void 0===a._thread){a._thread=e,a._promise=null,i.hasInitialize&&a.broadcast({},"initialize");var t,r=Object(I.a)(a._listeners);try{for(r.s();!(t=r.n()).done;){var n=t.value;a._connectListener(n)}}catch(o){r.e(o)}finally{r.f()}}else e.close()})),this._promise.catch((function(e){return M.error("Failed to initialize ".concat(t," worker: ").concat(e))}))}return Object(s.a)(e,[{key:"on",value:function(e,t){var r=this,n={removed:!1,eventName:e,callback:t,threadHandle:null};return this._listeners.push(n),this._connectListener(n),Object(D.b)((function(){n.removed=!0,Object(V.i)(r._listeners,n),r._thread&&Object(d.i)(n.threadHandle)&&n.threadHandle.remove()}))}},{key:"destroy",value:function(){this._thread&&(this._thread.close(),this._thread=null),this._promise=null}},{key:"invoke",value:function(e,t){return this.invokeMethod(this._mainMethod,e,t)}},{key:"invokeMethod",value:function(e,t,r){var n=this;if(this._thread){var a=this.getTransferList(t,e);return this._thread.invoke(e,t,{transferList:a,signal:r})}return this._promise?this._promise.then((function(){return Object(O.u)(r),n.invokeMethod(e,t,r)})):Promise.reject(null)}},{key:"broadcast",value:function(e,t){var r=this;return this._thread?Promise.all(this._thread.broadcast(t,e)).then((function(){})):this._promise?this._promise.then((function(){return r.broadcast(e,t)})):Promise.reject()}},{key:"promise",get:function(){return this._promise}},{key:"_connectListener",value:function(e){this._thread&&this._thread.on(e.eventName,e.callback).then((function(t){e.removed||(e.threadHandle=t)}))}}]),e}()),A=new Map;function C(e){var t=A.get(e);return t||(t={instance:new P(e),ref:0},A.set(e,t)),++t.ref,t.instance}var J=p.a.getLogger("esri.layers.ElevationLayer"),N=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(c.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).copyright=null,e.heightModelInfo=null,e.path=null,e.opacity=1,e.operationalLayerType="ArcGISTiledElevationServiceLayer",e.sourceJSON=null,e.type="elevation",e.url=null,e.version=null,e._lercDecoder=C(),e}return Object(s.a)(n,[{key:"normalizeCtorArgs",value:function(e,t){return"string"==typeof e?Object(o.a)({url:e},t):e}},{key:"destroy",value:function(){(function(e){if(null!=e){var t=e.scheduler,r=A.get(t);r&&--r.ref<=0&&(r.instance.destroy(),A.delete(t))}})(this._lercDecoder),this._lercDecoder=null}},{key:"minScale",get:function(){},set:function(e){this.constructed&&J.warn("".concat(this.declaredClass,".minScale support has been removed (since 4.5)"))}},{key:"maxScale",get:function(){},set:function(e){this.constructed&&J.warn("".concat(this.declaredClass,".maxScale support has been removed (since 4.5)"))}},{key:"readVersion",value:function(e,t){var r=t.currentVersion;return r||(r=9.3),r}},{key:"load",value:function(e){var t=this,r=Object(d.i)(e)?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Image Service"],supportsData:!1,validateItem:function(e){for(var t=0;t<e.typeKeywords.length;t++)if("elevation 3d layer"===e.typeKeywords[t].toLowerCase())return!0;throw new f.a("portal:invalid-layer-item-type","Invalid layer item type '${type}', expected '${expectedType}' ",{type:"Image Service",expectedType:"Image Service Elevation 3D Layer"})}},e).then((function(){return t._fetchImageService(r)}),(function(){return t._fetchImageService(r)}))),Promise.resolve(this)}},{key:"fetchTile",value:function(e,t,r,n){var a=this,i=Object(d.i)((n=n||{signal:null}).signal)?n.signal:n.signal=Object(O.d)().signal,o={responseType:"array-buffer",signal:i},c={noDataValue:n.noDataValue,returnFileInfo:!0};return this.load().then((function(){return a._fetchTileAvailability(e,t,r,n)})).then((function(){return Object(m.default)(a.getTileUrl(e,t,r),o)})).then((function(e){return a._lercDecoder.decode(e.data,c,i)})).then((function(e){return{values:e.pixelData,width:e.width,height:e.height,maxZError:e.fileInfo.maxZError,noDataValue:e.noDataValue,minValue:e.minValue,maxValue:e.maxValue}}))}},{key:"getTileUrl",value:function(e,t,r){var n=!this.tilemapCache&&this.supportsBlankTile,a=Object(j.D)(Object(o.a)(Object(o.a)({},this.parsedUrl.query),{},{blankTile:!n&&null}));return"".concat(this.parsedUrl.path,"/tile/").concat(e,"/").concat(t,"/").concat(r).concat(a?"?"+a:"")}},{key:"queryElevation",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n){var i,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.e(12).then(r.bind(null,888));case 2:return i=e.sent,o=i.ElevationQuery,Object(O.u)(n),e.abrupt("return",(new o).query(this,t,n));case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"createElevationSampler",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n){var i,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.e(12).then(r.bind(null,888));case 2:return i=e.sent,o=i.ElevationQuery,Object(O.u)(n),e.abrupt("return",(new o).createSampler(this,t,n));case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_fetchTileAvailability",value:function(e,t,r,n){return this.tilemapCache?this.tilemapCache.fetchAvailability(e,t,r,n):Promise.resolve("unknown")}},{key:"_fetchImageService",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var r,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.sourceJSON){e.next=2;break}return e.abrupt("return",this.sourceJSON);case 2:return r={query:Object(o.a)({f:"json"},this.parsedUrl.query),responseType:"json",signal:t},e.next=5,Object(m.default)(this.parsedUrl.path,r);case 5:(n=e.sent).ssl&&(this.url=this.url.replace(/^http:/i,"https:")),this.sourceJSON=n.data,this.read(n.data,{origin:"service",url:this.parsedUrl});case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(Object(L.a)(Object(x.a)(Object(S.a)(Object(T.a)(Object(k.a)(g.a))))));Object(h.a)([Object(v.b)({json:{read:{source:"copyrightText"}}})],N.prototype,"copyright",void 0),Object(h.a)([Object(v.b)({readOnly:!0,type:w.a})],N.prototype,"heightModelInfo",void 0),Object(h.a)([Object(v.b)({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],N.prototype,"path",void 0),Object(h.a)([Object(v.b)({type:["show","hide"]})],N.prototype,"listMode",void 0),Object(h.a)([Object(v.b)({json:{read:!1,write:!1,origins:{service:{read:!1,write:!1},"portal-item":{read:!1,write:!1},"web-document":{read:!1,write:!1}}}})],N.prototype,"minScale",null),Object(h.a)([Object(v.b)({json:{read:!1,write:!1,origins:{service:{read:!1,write:!1},"portal-item":{read:!1,write:!1},"web-document":{read:!1,write:!1}}}})],N.prototype,"maxScale",null),Object(h.a)([Object(v.b)({json:{read:!1,write:!1,origins:{"web-document":{read:!1,write:!1}}}})],N.prototype,"opacity",void 0),Object(h.a)([Object(v.b)({type:["ArcGISTiledElevationServiceLayer"]})],N.prototype,"operationalLayerType",void 0),Object(h.a)([Object(v.b)()],N.prototype,"sourceJSON",void 0),Object(h.a)([Object(v.b)({json:{read:!1},value:"elevation",readOnly:!0})],N.prototype,"type",void 0),Object(h.a)([Object(v.b)(_.n)],N.prototype,"url",void 0),Object(h.a)([Object(v.b)()],N.prototype,"version",void 0),Object(h.a)([Object(b.a)("version",["currentVersion"])],N.prototype,"readVersion",null);var U=N=Object(h.a)([Object(y.a)("esri.layers.ElevationLayer")],N);t.default=U}}]);
//# sourceMappingURL=34.915b97fe.chunk.js.map